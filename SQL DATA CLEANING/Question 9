

WITH t1 AS (
SELECT LEFT(primary_poc,STRPOS(primary_poc,' ')) AS first_name,
RIGHT(primary_poc,LENGTH(primary_poc)-STRPOS(primary_poc,' ')) AS last_name,REPLACE(name,' ','') AS names,*
FROM accounts
),
t2 AS (SELECT CONCAT(LEFT(LOWER(first_name),1),RIGHT(LOWER(first_name),2),             LEFT(LOWER(last_name),1),RIGHT(LOWER(last_name),1),LENGTH(first_name),LENGTH(last_name),UPPER(names)) as Pass,*
FROM t1)
                     
SELECT REPLACE(pass,' ','') AS password
FROM t2
